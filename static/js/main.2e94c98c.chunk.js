(this.webpackJsonpproximitylab=this.webpackJsonpproximitylab||[]).push([[0],{20:function(t,e,a){},21:function(t,e,a){},24:function(t,e,a){},30:function(t,e,a){"use strict";a.r(e);var c=a(2),n=a.n(c),i=a(13),o=a.n(i),s=(a(20),a(7)),r=(a(21),a(8)),l=a(32),d=a(33),j=a(34),u=a(35),b=a(36),h=a(37),f=a(38),m=(a(24),a.p+"static/media/guide.27a484ad.JPG"),x=a(11),O=function t(e,a){Object(x.a)(this,t),this.timestamp=e,this.aqi=a},y=function t(e){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];Object(x.a)(this,t),this.cityName=e,this.dataPoints=a},p=a(1),g=function(t){var e=t.citiesData,a=t.selectedCityRowData,n=t.onRowSelect,i=Object(c.useState)([]),o=Object(s.a)(i,2),x=o[0],g=o[1];Object(c.useEffect)((function(){v()}),[e]);var v=function(){var t=Object(r.clone)(x);e.forEach((function(e){var a,c,n=e.city,i=e.aqi,o=(a=parseFloat(i),c=2,parseFloat(a.toFixed(c))),s=(new Date).getTime(),r=new O(s,o),l=t.filter((function(t){return t.cityName.toLowerCase()===n.toLowerCase()}))[0];if(l){var d=l.dataPoints;d.length>=20&&d.shift(),d.push(r)}else{var j=new y(n,[r]);t.push(j)}})),t.forEach((function(t){t.lastUpdateStatus=N(t.dataPoints[t.dataPoints.length-1].timestamp)})),g(t)},w=function(t){var e="aqi";return(t=Math.floor(t))>=0&&t<=50?e+=" good":t>=51&&t<=100?e+=" satisfactory":t>=101&&t<=200?e+=" moderate":t>=201&&t<=300?e+=" poor":t>=301&&t<=400?e+=" verypoor":t>=401&&t<=500&&(e+=" severe"),e},N=function(t){var e=new Date(t),a=((new Date).getTime()-e.getTime())/1e3;return a<1?"few milliseconds ago":"".concat(Math.floor(a)," seconds ago")};return Object(p.jsxs)("div",{children:[Object(p.jsx)("h2",{tag:"h5",className:"margin50",children:"Air Quality Index"}),Object(p.jsxs)(l.a,{className:"margin50",children:[Object(p.jsx)(d.a,{children:Object(p.jsx)("div",{className:"text-center aqitable",children:Object(p.jsxs)(j.a,{bordered:!0,children:[Object(p.jsx)("thead",{children:Object(p.jsxs)("tr",{style:{display:"fixed"},children:[Object(p.jsx)("th",{children:"#"}),Object(p.jsx)("th",{children:"City"}),Object(p.jsx)("th",{children:"Current AQI"}),Object(p.jsx)("th",{children:"Last Updated"})]})}),Object(p.jsx)("tbody",{children:x.map((function(t,e){return Object(p.jsxs)("tr",{className:a&&a.cityName===t.cityName?"selected":"",onClick:function(){return n(t)},children:[Object(p.jsx)("th",{scope:"row",children:e+1}),Object(p.jsx)("td",{children:t.cityName}),Object(p.jsx)("td",{className:w(t.dataPoints.slice(-1)[0].aqi),children:t.dataPoints.slice(-1)[0].aqi}),Object(p.jsx)("td",{children:t.lastUpdateStatus})]},t.cityName)}))})]})})}),Object(p.jsx)(d.a,{className:"guideImgCol",children:Object(p.jsxs)(u.a,{children:[Object(p.jsx)(b.a,{children:Object(p.jsx)(h.a,{tag:"h5",children:"Guide To Air Quality Index"})}),Object(p.jsx)(f.a,{top:!0,src:m,alt:"AQI Guide"})]})})]})]})},v=a(15),w=a(14),N=a.n(w),C=function(t){var e=t.cityName,a=t.dataPoints,n=Object(c.useState)([]),i=Object(s.a)(n,2),o=i[0],l=i[1],d=Object(c.useState)({}),j=Object(s.a)(d,2),u=j[0],b=j[1];return Object(c.useEffect)((function(){!function(){var t=[],c=a.map((function(t){return t.timestamp})),n=Math.min.apply(Math,Object(v.a)(c)),i=Object(r.clone)(function(t,e){return{series:[{data:[]}],chart:{id:"area-datetime",type:"area",height:350,zoom:{autoScaleYaxis:!0}},annotations:{yaxis:[{y:51,borderColor:"#999",label:{show:!0,text:"Satisfactory",style:{color:"#fff",background:"#00E396"}}},{y:101,borderColor:"#999",label:{show:!0,text:"Moderate",style:{color:"#fff",background:"#00E396"}}},{y:201,borderColor:"#999",label:{show:!0,text:"Poor",style:{color:"#fff",background:"#00E396"}}},{y:301,borderColor:"#999",label:{show:!0,text:"Very Poor",style:{color:"#fff",background:"#00E396"}}},{y:401,borderColor:"#999",label:{show:!0,text:"Severe",style:{color:"#fff",background:"#00E396"}}}]},dataLabels:{enabled:!1},markers:{size:0,style:"hollow"},title:{text:"".concat(t," Air Quality Index"),align:"center"},xaxis:{type:"datetime",min:e,tickAmount:6,labels:{formatter:function(t){return new Date(t).toString().slice(0,24)}},title:{text:"Timestamp"}},yaxis:{labels:{formatter:function(t){return t}},title:{text:"Air Quality Index"}},fill:{type:"gradient",gradient:{shadeIntensity:1,opacityFrom:.7,opacityTo:.9,stops:[0,100]}}}}(e,n));t=a.map((function(t){return[t.timestamp,t.aqi]})),i.series=[{data:t}],l([{data:t}]),b(i)}()}),[a[a.length-1]]),Object(p.jsx)("div",{id:"chart",children:Object(p.jsx)(N.a,{series:o,options:u,type:"area",height:350})})};var S=function(){var t=new WebSocket("wss://city-ws.herokuapp.com/"),e=Object(c.useState)([]),a=Object(s.a)(e,2),n=a[0],i=a[1],o=Object(c.useState)(null),l=Object(s.a)(o,2),d=l[0],j=l[1];Object(c.useEffect)((function(){u()}),[]);var u=function(){t.onopen=function(){console.log("connected")},t.onmessage=Object(r.throttle)((function(t){var e=JSON.parse(t.data);i(e)}),300),t.onclose=function(){console.log("disconnected")}};return Object(p.jsxs)("div",{className:"App",children:[Object(p.jsx)(g,{citiesData:n,selectedCityRowData:d,onRowSelect:function(t){return e=t,void j(Object(r.clone)(e));var e}}),d&&Object(p.jsx)("div",{className:"chartContainer",children:Object(p.jsx)(C,{cityName:d.cityName,dataPoints:d.dataPoints})})]})},P=function(t){t&&t instanceof Function&&a.e(3).then(a.bind(null,39)).then((function(e){var a=e.getCLS,c=e.getFID,n=e.getFCP,i=e.getLCP,o=e.getTTFB;a(t),c(t),n(t),i(t),o(t)}))};a(29);o.a.render(Object(p.jsx)(n.a.StrictMode,{children:Object(p.jsx)(S,{})}),document.getElementById("root")),P()}},[[30,1,2]]]);
//# sourceMappingURL=main.2e94c98c.chunk.js.map